

```{R}

library(DESeq2)
library(dplyr)
library(ContrApption)
```

    debug (console only):
      devtools::install(); library(ContrApption); ContrApption(data = d, annotation = annotation, idCol = "SampleID", groupCol = "Group")
    
```{R}

dds <- readRDS("dev/lncDESeq2Obj.Rds")

d <- counts(dds, normalized = TRUE)

d %>% class

d %>% head
```

```{R}

colData(dds)

annotation <- colData(dds)

annotation$SampleID <- as.character(annotation$SampleID)

annotation$Group <- as.character(annotation$Group)

annotation <- annotation %>% as.matrix
```

## Group

```{R}

class(d)
class(annotation)

ContrApption(data = d, annotation = annotation, idCol = "SampleID", groupCol = "Group")
```

## Visit

```{R}
# need to make uuids before I can have more than one on the same page
ContrApption(data = d, annotation = annotation, idCol = "SampleID", groupCol = "Visit")
```

## Interaction 

```{R}

annotation$Interaction <- paste0(annotation$Group, ":", annotation$Visit)

annotation
```

```{R}
library(ContrApption)
# need to make uuids before I can have more than one on the same page
ContrApption(data = d, annotation = annotation, idCol = "SampleID", groupCol = "Interaction")
```


```{R}
devtools::install()
x <- c("PRKCQ-AS1", "HOXA-AS2", "LINC01094", "AL031123.2", "DICER1-AS1", "LINC02446", "AC018678.1", "AC127521.1", "LINC02021" , "MIR205HG")
z <- counts(dds, normalized = TRUE) %>% 
  data.frame %>% 
  dplyr::filter(rownames(.) %in% x) %>% 
  as.matrix
ContrApption(data = z, annotation = annotation, idCol = "SampleID", groupCol = "Group")

```
```{R}

sessionInfo()
```
