suppressMessages(library(pasilla))
# loads sample annotation from the pasilla package
pasAnno <- system.file("extdata", "pasilla_sample_annotation.csv", package = "pasilla", mustWork = TRUE)
# read in the sample data
coldata <- read.csv(pasAnno, row.names = 1)
# select relevant columns
coldata <- data.frame(coldata[ , c("condition","type")])
# remove un-needed characters
rownames(coldata) <- gsub("fb", "", rownames(coldata))
coldata
# loads counts file from the pasilla package
pasCts <- system.file("extdata", "pasilla_gene_counts.tsv", package = "pasilla", mustWork = TRUE)
# reads counts of genes
cts <- read.csv(pasCts, sep = "\t", row.names = "gene_id")
# make sure the order is correct
cts <- cts[, rownames(coldata)]
head(cts)
# create a DESeq2 dataset from the metadata and counts
dds <- DESeq(DESeqDataSetFromMatrix(countData = cts, colData = coldata, design = ~ condition))
normCounts <- counts(dds, normalized = TRUE)
res <- results(dds, tidy = TRUE) %>%
data.frame %>%
filter(padj < 0.05)
normCountsSig <- normCounts %>%
data.frame %>%
filter(rownames(.) %in% res$row)
normCountsSig %>% nrow
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library(ContrApption)
library(dplyr)
suppressMessages(library(DESeq2))
suppressMessages(library(pasilla))
# loads sample annotation from the pasilla package
pasAnno <- system.file("extdata", "pasilla_sample_annotation.csv", package = "pasilla", mustWork = TRUE)
# read in the sample data
coldata <- read.csv(pasAnno, row.names = 1)
# select relevant columns
coldata <- data.frame(coldata[ , c("condition","type")])
# remove un-needed characters
rownames(coldata) <- gsub("fb", "", rownames(coldata))
coldata
# loads counts file from the pasilla package
pasCts <- system.file("extdata", "pasilla_gene_counts.tsv", package = "pasilla", mustWork = TRUE)
# reads counts of genes
cts <- read.csv(pasCts, sep = "\t", row.names = "gene_id")
# make sure the order is correct
cts <- cts[, rownames(coldata)]
head(cts)
# create a DESeq2 dataset from the metadata and counts
dds <- DESeq(DESeqDataSetFromMatrix(countData = cts, colData = coldata, design = ~ condition))
normCounts <- counts(dds, normalized = TRUE)
res <- results(dds, tidy = TRUE) %>%
data.frame %>%
filter(padj < 0.05)
normCountsSig <- normCounts %>%
data.frame %>%
filter(rownames(.) %in% res$row)
normCountsSig %>% nrow
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
system("./fullRebuild.sh")
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library(ContrApption)
library(dplyr)
suppressMessages(library(DESeq2))
suppressMessages(library(pasilla))
# loads sample annotation from the pasilla package
pasAnno <- system.file("extdata", "pasilla_sample_annotation.csv", package = "pasilla", mustWork = TRUE)
# read in the sample data
coldata <- read.csv(pasAnno, row.names = 1)
# select relevant columns
coldata <- data.frame(coldata[ , c("condition","type")])
# remove un-needed characters
rownames(coldata) <- gsub("fb", "", rownames(coldata))
coldata
# loads counts file from the pasilla package
pasCts <- system.file("extdata", "pasilla_gene_counts.tsv", package = "pasilla", mustWork = TRUE)
# reads counts of genes
cts <- read.csv(pasCts, sep = "\t", row.names = "gene_id")
# make sure the order is correct
cts <- cts[, rownames(coldata)]
head(cts)
# create a DESeq2 dataset from the metadata and counts
dds <- DESeq(DESeqDataSetFromMatrix(countData = cts, colData = coldata, design = ~ condition))
normCounts <- counts(dds, normalized = TRUE)
res <- results(dds, tidy = TRUE) %>%
data.frame %>%
filter(padj < 0.05)
normCountsSig <- normCounts %>%
data.frame %>%
filter(rownames(.) %in% res$row)
normCountsSig %>% nrow
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
devtools::install()
library(dplyr)
library(DESeq2)
library(ContrApption)
# loads sample annotation from the pasilla package
pasAnno <- system.file("extdata", "pasilla_sample_annotation.csv", package = "pasilla", mustWork = TRUE)
# read in the sample data
coldata <- read.csv(pasAnno, row.names = 1)
# select relevant columns
coldata <- data.frame(coldata[ , c("condition","type")])
# remove un-needed characters
rownames(coldata) <- gsub("fb", "", rownames(coldata))
# loads counts file from the pasilla package
pasCts <- system.file("extdata", "pasilla_gene_counts.tsv", package = "pasilla", mustWork = TRUE)
# reads counts of genes
cts <- read.csv(pasCts, sep = "\t", row.names = "gene_id")
# make sure the order is correct
cts <- cts[, rownames(coldata)]
# create a DESeq2 dataset from the metadata and counts
dds <- DESeq(DESeqDataSetFromMatrix(countData = cts, colData = coldata, design = ~ condition))
normCounts <- counts(dds, normalized = TRUE)
res <- results(dds, tidy = TRUE) %>%
data.frame %>%
filter(padj < 0.05)
normCountsSig <- normCounts %>%
data.frame %>%
filter(rownames(.) %in% res$row)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
devtools::install()
library(dplyr)
library(DESeq2)
library(ContrApption)
# loads sample annotation from the pasilla package
pasAnno <- system.file("extdata", "pasilla_sample_annotation.csv", package = "pasilla", mustWork = TRUE)
# read in the sample data
coldata <- read.csv(pasAnno, row.names = 1)
# select relevant columns
coldata <- data.frame(coldata[ , c("condition","type")])
# remove un-needed characters
rownames(coldata) <- gsub("fb", "", rownames(coldata))
# loads counts file from the pasilla package
pasCts <- system.file("extdata", "pasilla_gene_counts.tsv", package = "pasilla", mustWork = TRUE)
# reads counts of genes
cts <- read.csv(pasCts, sep = "\t", row.names = "gene_id")
# make sure the order is correct
cts <- cts[, rownames(coldata)]
# create a DESeq2 dataset from the metadata and counts
dds <- DESeq(DESeqDataSetFromMatrix(countData = cts, colData = coldata, design = ~ condition))
normCounts <- counts(dds, normalized = TRUE)
res <- results(dds, tidy = TRUE) %>%
data.frame %>%
filter(padj < 0.05)
normCountsSig <- normCounts %>%
data.frame %>%
filter(rownames(.) %in% res$row)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
devtools::install()
library(dplyr)
library(DESeq2)
library(ContrApption)
# loads sample annotation from the pasilla package
pasAnno <- system.file("extdata", "pasilla_sample_annotation.csv", package = "pasilla", mustWork = TRUE)
# read in the sample data
coldata <- read.csv(pasAnno, row.names = 1)
# select relevant columns
coldata <- data.frame(coldata[ , c("condition","type")])
# remove un-needed characters
rownames(coldata) <- gsub("fb", "", rownames(coldata))
# loads counts file from the pasilla package
pasCts <- system.file("extdata", "pasilla_gene_counts.tsv", package = "pasilla", mustWork = TRUE)
# reads counts of genes
cts <- read.csv(pasCts, sep = "\t", row.names = "gene_id")
# make sure the order is correct
cts <- cts[, rownames(coldata)]
# create a DESeq2 dataset from the metadata and counts
dds <- DESeq(DESeqDataSetFromMatrix(countData = cts, colData = coldata, design = ~ condition))
normCounts <- counts(dds, normalized = TRUE)
res <- results(dds, tidy = TRUE) %>%
data.frame %>%
filter(padj < 0.05)
normCountsSig <- normCounts %>%
data.frame %>%
filter(rownames(.) %in% res$row)
save.image("Test")
load("Test")
devtools::install()
library(ContrApption)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
load("Test")
devtools::install()
library(ContrApption)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
load("Test")
devtools::install()
library(ContrApption)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
load("Test")
devtools::install()
load("Test")
devtools::install()
library(ContrApption)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
load("Test")
devtools::install()
library(ContrApption)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
load("Test")
devtools::install()
library(ContrApption)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
load("Test")
devtools::install()
library(ContrApption)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
load("Test")
devtools::install()
library(ContrApption)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
load("Test")
devtools::install()
library(ContrApption)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
load("Test")
devtools::install()
library(ContrApption)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
load("Test")
devtools::install()
library(ContrApption)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
load("Test")
devtools::install()
library(ContrApption)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
load("Test")
devtools::install()
library(ContrApption)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
load("Test")
devtools::install()
library(ContrApption)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
load("Test")
devtools::install()
library(ContrApption)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
load("Test")
devtools::install()
load("Test")
devtools::install()
library(ContrApption)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
load("Test")
devtools::install()
library(ContrApption)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
load("Test")
devtools::install()
library(ContrApption)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
load("Test")
devtools::install()
library(ContrApption)
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
devtools::install()
library(ContrApption)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
devtools::install()
devtools::install()
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library(ContrApption)
library(dplyr)
suppressMessages(library(DESeq2))
suppressMessages(library(pasilla))
# loads sample annotation from the pasilla package
pasAnno <- system.file("extdata", "pasilla_sample_annotation.csv", package = "pasilla", mustWork = TRUE)
# read in the sample data
coldata <- read.csv(pasAnno, row.names = 1)
# select relevant columns
coldata <- data.frame(coldata[ , c("condition","type")])
# remove un-needed characters
rownames(coldata) <- gsub("fb", "", rownames(coldata))
coldata
# loads counts file from the pasilla package
pasCts <- system.file("extdata", "pasilla_gene_counts.tsv", package = "pasilla", mustWork = TRUE)
# reads counts of genes
cts <- read.csv(pasCts, sep = "\t", row.names = "gene_id")
# make sure the order is correct
cts <- cts[, rownames(coldata)]
head(cts)
# create a DESeq2 dataset from the metadata and counts
dds <- DESeq(DESeqDataSetFromMatrix(countData = cts, colData = coldata, design = ~ condition))
normCounts <- counts(dds, normalized = TRUE)
res <- results(dds, tidy = TRUE) %>%
data.frame %>%
filter(padj < 0.05)
normCountsSig <- normCounts %>%
data.frame %>%
filter(rownames(.) %in% res$row)
normCountsSig %>% nrow
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "type")
# derive a new variable - every combitation of condition and type
coldata$interaction <- paste0(coldata$condition, ":", coldata$type)
head(coldata)
# pass our new variable
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "interaction")
sessionInfo()
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library(ContrApption)
library(dplyr)
suppressMessages(library(DESeq2))
suppressMessages(library(pasilla))
# loads sample annotation from the pasilla package
pasAnno <- system.file("extdata", "pasilla_sample_annotation.csv", package = "pasilla", mustWork = TRUE)
# read in the sample data
coldata <- read.csv(pasAnno, row.names = 1)
# select relevant columns
coldata <- data.frame(coldata[ , c("condition","type")])
# remove un-needed characters
rownames(coldata) <- gsub("fb", "", rownames(coldata))
coldata
# loads counts file from the pasilla package
pasCts <- system.file("extdata", "pasilla_gene_counts.tsv", package = "pasilla", mustWork = TRUE)
# reads counts of genes
cts <- read.csv(pasCts, sep = "\t", row.names = "gene_id")
# make sure the order is correct
cts <- cts[, rownames(coldata)]
head(cts)
# create a DESeq2 dataset from the metadata and counts
dds <- DESeq(DESeqDataSetFromMatrix(countData = cts, colData = coldata, design = ~ condition))
normCounts <- counts(dds, normalized = TRUE)
res <- results(dds, tidy = TRUE) %>%
data.frame %>%
filter(padj < 0.05)
normCountsSig <- normCounts %>%
data.frame %>%
filter(rownames(.) %in% res$row)
normCountsSig %>% nrow
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "condition")
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "type")
# derive a new variable - every combitation of condition and type
coldata$interaction <- paste0(coldata$condition, ":", coldata$type)
head(coldata)
# pass our new variable
ContrApption(data = normCountsSig, annotation = coldata, groupCol = "interaction")
sessionInfo()
Note that users interested in this sort of experiment would generally re-run DESeq2 with a different experimental design:
>DESeq(DESeqDataSetFromMatrix(countData = cts, colData = coldata, design = ~ condition * type))
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
system("./fullRebuild.sh")
browseVignettes("ContrApption")
devtools::build()
devtools::build()
system("./fullRebuild.sh")
